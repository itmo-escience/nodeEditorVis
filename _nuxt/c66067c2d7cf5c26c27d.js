(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{253:function(t,e,n){var content=n(336);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("369215db",content,!0,{sourceMap:!1})},254:function(t,e,n){var content=n(338);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("4b19cbba",content,!0,{sourceMap:!1})},255:function(t,e,n){var content=n(340);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("2690ed5a",content,!0,{sourceMap:!1})},256:function(t,e,n){var content=n(343);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("2f5276f4",content,!0,{sourceMap:!1})},257:function(t,e,n){var content=n(345);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("3c0248ba",content,!0,{sourceMap:!1})},258:function(t,e,n){var content=n(349);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("4aab2ba8",content,!0,{sourceMap:!1})},259:function(t,e,n){var content=n(351);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("98163e84",content,!0,{sourceMap:!1})},260:function(t,e,n){var content=n(354);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("d0087340",content,!0,{sourceMap:!1})},261:function(t,e,n){var content=n(356);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("e3f00334",content,!0,{sourceMap:!1})},262:function(t,e,n){var content=n(358);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("249d4ab8",content,!0,{sourceMap:!1})},314:function(t,e){},329:function(t,e){},335:function(t,e,n){"use strict";var r=n(253);n.n(r).a},336:function(t,e,n){var r=n(55),o=n(109),c=n(110);e=r(!1);var d=o(c);e.push([t.i,".preview.active{color:#e3c000;border-color:#e3c000!important}.map-container{position:relative;width:500px;height:500px;margin:15px}.map-container.hidden{visibility:hidden}.add{margin-left:5px}.add:after{content:url("+d+");position:relative;top:5px;left:5px}",""]),t.exports=e},337:function(t,e,n){"use strict";var r=n(254);n.n(r).a},338:function(t,e,n){(e=n(55)(!1)).push([t.i,".pallet{position:absolute}",""]),t.exports=e},339:function(t,e,n){"use strict";var r=n(255);n.n(r).a},340:function(t,e,n){var r=n(55),o=n(109),c=n(110),d=n(341);e=r(!1);var l=o(c),h=o(d);e.push([t.i,"input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield;text-align:center;width:100px}.minus,.plus{margin:0 10px}.plus:after{content:url("+l+");position:relative;top:-2px}.minus:after{content:url("+h+")}",""]),t.exports=e},341:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xMiAxMkgxOE0xMiAxMkg2TTEyIiBzdHJva2U9IiNmZmZmIiBzdHJva2Utd2lkdGg9IjEuOCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8L3N2Zz4="},342:function(t,e,n){"use strict";var r=n(256);n.n(r).a},343:function(t,e,n){(e=n(55)(!1)).push([t.i,".dropdown{position:relative}.ghost{visibility:hidden}.dropdown-control,.dropdown-menu{background:#353535;color:#d5d6d6}.dropdown-control{border:1px solid #d5d6d6;border-radius:4px}.dropdown-control.opened{border-radius:4px 4px 0 0}.dropdown-control,.dropdown-menu-item{padding:5px;height:30px}.dropdown-menu{position:absolute;width:100%;z-index:3;border-radius:0 0 4px 4px}.dropdown-menu-item:hover{color:#e3c000}.dropdown-menu-item.selected{background:#d5d6d6;color:#353535}",""]),t.exports=e},344:function(t,e,n){"use strict";var r=n(257);n.n(r).a},345:function(t,e,n){(e=n(55)(!1)).push([t.i,".color-control{margin:0 10px}",""]),t.exports=e},346:function(t,e,n){t.exports=n.p+"img/a4f018b.svg"},347:function(t,e,n){t.exports=n.p+"img/9091035.svg"},348:function(t,e,n){"use strict";var r=n(258);n.n(r).a},349:function(t,e,n){(e=n(55)(!1)).push([t.i,".files{margin:10px 10px 0;padding:20px 0;border:1px dashed #353535;border-radius:4px}.files.highlighted{border-color:#e3c000}.file-type{width:50px;height:50px}",""]),t.exports=e},350:function(t,e,n){"use strict";var r=n(259);n.n(r).a},351:function(t,e,n){(e=n(55)(!1)).push([t.i,".pallet{position:absolute;z-index:1}",""]),t.exports=e},352:function(t,e,n){t.exports=n.p+"img/c513ef4.svg"},353:function(t,e,n){"use strict";var r=n(260);n.n(r).a},354:function(t,e,n){(e=n(55)(!1)).push([t.i,".loading{width:195px;height:50px}",""]),t.exports=e},355:function(t,e,n){"use strict";var r=n(261);n.n(r).a},356:function(t,e,n){(e=n(55)(!1)).push([t.i,"input[type=checkbox]{width:0;height:0}.checkmark{width:15px;height:15px;border-radius:4px;margin-right:10px;border:1px solid #d5d6d6;background:#353535}input[type=checkbox]:checked~.checkmark{background:#d5d6d6}",""]),t.exports=e},357:function(t,e,n){"use strict";var r=n(262);n.n(r).a},358:function(t,e,n){var r=n(55),o=n(109),c=n(110);e=r(!1);var d=o(c);e.push([t.i,".color-pallet{position:absolute;top:20px;z-index:3}.trigger{height:15px}.add-color{content:url("+d+")}",""]),t.exports=e},380:function(t,e,n){"use strict";n.r(e);n(122);var r=n(27),o=(n(307),n(205),n(40),n(5)),c=(n(75),n(77),n(265),n(57),n(21),n(14),n(202)),d=n(210),l=n(229),h=n(311),f=n(211),v=(n(84),n(31),n(59),n(39)),m=(n(58),n(266),n(183)),y=n(184),w=n(186),x=n(185),k=n(187),C=(n(269),n(313),{mixins:[f.a.mixin],components:{Socket:f.a.Socket},data:function(){return{size:500,offset:30}},methods:{makeScale:function(t){return isNaN(t[0])?t[0].includes("-")?d.scaleTime().domain(d.extent(t.map((function(t){return new Date("2000-"+t)})))):d.scalePoint().domain(t):d.scaleLinear().domain(d.extent(t))},updateChart:function(){var t=this;if(this.node.data.DATA){var e=Object(c.a)(new Set(this.node.data.DATA.map((function(t){return t.x})))).sort(),n=Object(c.a)(new Set(this.node.data.DATA.map((function(t){return t.y})))).sort(),s=Object(c.a)(new Set(this.node.data.DATA.map((function(t){return t.size})))).sort(),r={x:this.makeScale(e).range([this.offset,this.size-this.offset]),y:this.makeScale(n).range([this.size-this.offset,this.offset]),size:d.scaleSqrt().domain(d.extent(s)).range([0,30])};if(d.select(this.$refs.y).call(d.axisLeft(r.y)),d.select(this.$refs.x).call(d.axisBottom(r.x).ticks(12,"%b")),this.context.clearRect(0,0,this.size,this.size),this.context.save(),"point"===this.node.data.type&&this.node.data.DATA.forEach((function(e){var n=r.size(e.size)||6,o=r.x(e.x),c=r.y(e.y);t.context.beginPath(),t.context.moveTo(o+n,c),t.context.arc(o,c,n,0,2*Math.PI),t.context.fillStyle=e.color||"#e3c000",t.context.fill(),t.context.strokeStyle="#000",t.context.stroke()})),"line"===this.node.data.type)d.nest().key((function(t){return t.index})).entries(this.node.data.DATA).forEach((function(e){t.context.beginPath();var data=e.values.sort((function(a,b){return a.x-b.x}));t.context.moveTo(r.x(data[0].x),r.y(data[0].y)),data.forEach((function(e){t.context.lineTo(r.x(new Date("2000-"+e.x)),r.y(e.y))})),t.context.lineWidth=3,t.context.strokeStyle=t.node.data.colors[e.key]||t.node.data.colors[0],t.context.stroke()}));this.context.restore()}}},updated:function(){this.updateChart()},mounted:function(){this.context=this.$refs.container.getContext("2d"),this.updateChart()}}),O=n(20),j=Object(O.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node",class:t._f("kebab")([t.selected(),t.node.name])},[n("div",{staticClass:"title"},[t._v(t._s(t.node.name))]),t._v(" "),n("div",{staticClass:"node-body d-flex"},[n("div",{staticClass:"inputs"},[t._l(t.controls(),(function(t,e){return n("div",{directives:[{name:"control",rawName:"v-control",value:t,expression:"control"}],key:e,staticClass:"control"})})),t._v(" "),t._l(t.inputs(),(function(input){return n("div",{key:input.key,staticClass:"input d-flex align-center"},[n("Socket",{directives:[{name:"socket",rawName:"v-socket:input",value:input,expression:"input",arg:"input"}],attrs:{type:"input",socket:input.socket}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!input.showControl(),expression:"!input.showControl()"}],staticClass:"input-title"},[t._v(t._s(input.name))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:input.showControl(),expression:"input.showControl()"},{name:"control",rawName:"v-control",value:input.control,expression:"input.control"}],staticClass:"input-control"})],1)}))],2),t._v(" "),n("canvas",{ref:"container",attrs:{width:t.size,height:t.size}}),t._v(" "),n("svg",{staticClass:"absolute r-0",attrs:{width:t.size,height:t.size}},[n("g",{ref:"x",attrs:{transform:"translate(0, "+(t.size-t.offset)+")"}}),t._v(" "),n("g",{ref:"y",attrs:{transform:"translate("+t.offset+", 0)"}})])])])}),[],!1,null,null,null).exports,_=(n(247),n(85),n(115),n(381)),I=n(270),z=n.n(I),M=n(390),S=n(383),N=n(388),E=n(382),R=n(384),A={mixins:[f.a.mixin],components:{Socket:f.a.Socket},data:function(){return{deck:null,viewState:{latitude:59.92,longitude:30.29,zoom:8,pitch:0,bearing:0},freez:!1,name:this.node.data.name||this.node.name+this.node.data.id}},watch:{name:function(t){this.node.data.name=t,this.editor.nodeId=this.node.id,this.editor.trigger("process")}},methods:{preview:function(){this.node.data.preview=!this.node.data.preview,this.editor.nodeId=this.node.id,this.editor.trigger("process")},freezEditor:function(t){this.freez=t},addLayer:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var component,n,ins,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return component=t.editor.components.get("Map"),n=t.inputs(),ins=t.inputs().map((function(input){return input.key})).slice(1).concat(["layer"+t.inputs().length]),e.next=5,component.createNode({inputs:ins,preview:t.node.data.preview,id:t.node.data.id,name:t.node.data.name});case 5:(r=e.sent).position=t.node.position,t.editor.addNode(r),n.forEach((function(input,i){var e=input.connections[0];if(e){var output=e.output;t.editor.connect(output.node.outputs.get(output.key),r.inputs.get("layer"+i))}})),t.editor.removeNode(t.node);case 10:case"end":return e.stop()}}),e)})))()},strToRGBA:function(t){return t.replace(")","").split("(").slice(1)[0].split(",").map((function(t,i){return 3===i?250*+t:+t}))},updateMap:function(){var t=this;if(this.node.data.update){var e=this.node.data.layers;if(e){var n=[];e.forEach((function(e){var r,o=function(n){return t.strToRGBA(e.color||n.properties.color)};switch(e.type){case"hexagon":var c={data:e.data.features,getPosition:function(t){return t.geometry.coordinates},extruded:e.extruded,elevationScale:1,elevationRange:e.elevationRange,colorRange:e.colorRange.map((function(e){return t.strToRGBA(e)})),getElevationWeight:function(t){return t.properties.elevation||1},elevationAggregation:e.elevationAggMethod,getColorWeight:function(t){return t.properties.color||1},colorAggregation:e.colorAggMethod};r="hexagon"===e.grid_type?new N.a(c):new E.a(c);break;case"heatmap":r=new R.a({data:e.data.features,getPosition:function(t){return t.geometry.coordinates},getWeight:function(t){return e.weight||t.properties.weight},radiusPixels:e.radius||30,intensity:e.intensity||1,threshold:e.threshold||.2,colorRange:e.colorRange?e.colorRange.map((function(e){return t.strToRGBA(e)})):[[160,160,180,250],[10,100,100,250]]});break;case"arc":r=new M.a({data:e.data.features,getSourcePosition:function(t){return t.geometry.coordinates[0]},getTargetPosition:function(t){return t.geometry.coordinates[t.geometry.coordinates.length-1]},getSourceColor:o,getTargetColor:o,getWidth:function(t){return e.width||t.properties.width}});break;default:r=new S.a({data:e.data,pickable:!0,stroked:!1,filled:!0,extruded:!!e.extruded,lineWidthScale:20,lineWidthMinPixels:2,getFillColor:o,getLineColor:o,getRadius:function(t){return e.radius||t.properties.radius},getLineWidth:1,getElevation:function(t){return e.height||t.properties.height}})}n.push(r)})),this.deck.setProps({layers:n})}this.node.data.update=!1}}},mounted:function(){var t=this;this.$nextTick((function(){var map=new z.a.Map({accessToken:"pk.eyJ1Ijoia2FwYzNkIiwiYSI6ImNpbGpodG82czAwMmlubmtxamdsOHF0a3AifQ.xCbMUsy_a_0A9cd4GvjXKQ",container:t.$refs.map,interactive:!1,style:"mapbox://styles/mapbox/dark-v9",center:[t.viewState.longitude,t.viewState.latitude],zoom:t.viewState.zoom,pitch:t.viewState.pitch,bearing:t.viewState.bearing});t.deck=new _.a({canvas:t.$refs.canvas,width:500,height:500,initialViewState:t.viewState,controller:!0,onViewStateChange:function(t){var e=t.viewState;map.jumpTo({center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch})}}),t.node.data.update=!0,t.updateMap()})),this.editor.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)})),this.editor.on("zoom nodetranslate",(function(){return!t.freez}))},updated:function(){this.name.endsWith("undefined")&&(this.name=this.node.name+this.node.data.id),this.updateMap()}},P=(n(335),Object(O.a)(A,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node map-node",class:t._f("kebab")([t.selected(),t.node.name])},[n("div",{staticClass:"d-flex align-center justify-center"},[n("div",{staticClass:"title fg-9"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"textarea"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" ("+t._s(t.node.name)+")")]),t._v(" "),n("div",{staticClass:"preview btn",class:{active:t.node.data.preview},on:{click:t.preview}},[t._v("Preview")])]),t._v(" "),n("div",{staticClass:"node-body d-flex"},[n("div",{staticClass:"inputs"},[t._l(t.controls(),(function(t,e){return n("div",{directives:[{name:"control",rawName:"v-control",value:t,expression:"control"}],key:e,staticClass:"control"})})),t._v(" "),t._l(t.inputs(),(function(input){return n("div",{key:input.key,staticClass:"input"},[n("div",{staticClass:"d-flex"},[n("Socket",{directives:[{name:"socket",rawName:"v-socket:input",value:input,expression:"input",arg:"input"}],attrs:{type:"input",socket:input.socket}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!input.showControl(),expression:"!input.showControl()"}],staticClass:"input-title"},[t._v(t._s(input.name))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:input.showControl(),expression:"input.showControl()"},{name:"control",rawName:"v-control",value:input.control,expression:"input.control"}],staticClass:"input-control"})],1)])})),t._v(" "),n("div",{staticClass:"add",on:{click:t.addLayer}},[t._v("Add")])],2),t._v(" "),n("div",{staticClass:"map-container",class:{hidden:t.node.data.preview},on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}},[n("div",{ref:"map",staticClass:"mapbox"}),t._v(" "),n("canvas",{ref:"canvas",staticClass:"deck-canvas"})])])])}),[],!1,null,null,null).exports),D=(n(73),n(74),n(218)),L={components:{Chrome:D.Chrome},props:["emitter","ikey","node"],data:function(){return{color:"rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)"),opened:!1,freez:!1}},methods:{togglePallet:function(){this.opened=!this.opened},freezEditor:function(t){this.freez=t},updateValue:function(t){this.color="rgba(".concat(Object.values(t.rgba).toString(),")"),this.node.data.colors[this.ikey]=this.color}},mounted:function(){var t=this;this.color=this.node.data.colors[this.ikey]||this.color,this.node.data.colors[this.ikey]=this.color,this.emitter.on("nodetranslate",(function(){return!t.freez})),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)}))},beforeDestroy:function(){delete this.node.data.colors[this.ikey]}},F=(n(337),Object(O.a)(L,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}},[n("svg",{attrs:{height:"15",viewBox:"0 0 20 10"},on:{click:t.togglePallet}},[n("circle",{attrs:{cx:"10",cy:"5",r:"5",fill:t.color}})]),t._v(" "),t.opened?n("div",{staticClass:"pallet"},[n("Chrome",{attrs:{value:t.color},on:{input:t.updateValue}})],1):t._e()])}),[],!1,null,null,null).exports),T={mixins:[f.a.mixin],components:{Socket:f.a.Socket,Control:F},data:function(){return{colors:null}},updated:function(){var t=JSON.stringify(Object.values(this.node.data.colors));t!=this.colors&&(this.editor.nodeId=this.node.id,this.editor.trigger("process"),this.colors=t)}},$=Object(O.a)(T,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node",class:t._f("kebab")([t.selected(),t.node.name])},[n("div",{staticClass:"d-flex space-between"},[n("div",t._l(t.inputs(),(function(input){return n("div",{key:input.key,staticClass:"input d-flex align-center"},[n("Socket",{directives:[{name:"socket",rawName:"v-socket:input",value:input,expression:"input",arg:"input"}],attrs:{type:"input",socket:input.socket}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!input.showControl(),expression:"!input.showControl()"}],staticClass:"input-title"},[t._v(t._s(input.name))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:input.showControl(),expression:"input.showControl()"},{name:"control",rawName:"v-control",value:input.control,expression:"input.control"}],staticClass:"input-control"})],1)})),0),t._v(" "),n("div",t._l(t.outputs(),(function(output){return n("div",{key:output.key,staticClass:"output d-flex justify-end align-center"},[n("div",{staticClass:"fields-output-title"},[t._v(t._s(output.name))]),t._v(" "),n("Socket",{directives:[{name:"socket",rawName:"v-socket:output",value:output,expression:"output",arg:"output"}],attrs:{type:"output",socket:output.socket}})],1)})),0)]),t._v(" "),t.node.data.values?n("div",{staticClass:"mrr-20 mrl-20"},t._l(t.node.data.values,(function(e){return n("div",{key:e,staticClass:"d-flex align-center mrv-10"},[n("Control",{attrs:{emitter:t.editor,node:t.node,ikey:e}}),t._v(" "),n("div",[t._v(t._s(e?e.length>15?e.toString().slice(0,15)+"...":e.toString().slice(0,15):"Null"))])],1)})),0):t._e()])}),[],!1,null,null,null).exports,G={mixins:[f.a.mixin],components:{Socket:f.a.Socket},data:function(){return{freez:!1,nodes:null,links:null,simulation:null,context:null,canvas:null,transform:d.zoomIdentity}},methods:{freezEditor:function(t){this.freez=t},zoom:function(){this.transform=d.event.transform,this.redraw()},drawLink:function(t){this.context.moveTo(t.source.x,t.source.y),this.context.lineTo(t.target.x,t.target.y)},drawNode:function(t){var e=Math.max(t.radius,3);this.context.beginPath(),this.context.moveTo(t.x+e,t.y),this.context.arc(t.x,t.y,e,0,2*Math.PI),this.context.fillStyle=t.color||"#e3c000",this.context.fill()},redraw:function(){this.context.clearRect(0,0,500,500),this.context.save(),this.context.translate(this.transform.x,this.transform.y),this.context.scale(this.transform.k,this.transform.k),this.links&&(this.context.beginPath(),this.links.forEach(this.drawLink),this.context.strokeStyle="#aaa",this.context.stroke()),this.nodes.forEach(this.drawNode),this.context.restore()},updateGraph:function(){var data=this.node.data;this.nodes=data.GRAPH.nodes,this.links=data.GRAPH.links,this.simulation=d.forceSimulation(this.nodes).force("x",d.forceX().x((function(t){return t.xpos})).strength((function(t){return t.xstr}))).force("y",d.forceY().y((function(t){return t.ypos})).strength((function(t){return t.ystr}))).force("charge",d.forceManyBody().strength((function(t){return t.cstr}))).force("radial",d.forceRadial.apply(d,[function(t){return t.rad}].concat(Object(c.a)(data.GRAPH.radialCenter))).strength((function(t){return t.rstr}))).force("collide",d.forceCollide().radius((function(t){return Math.max(t.radius,3)})).iterations(2)),this.links&&this.simulation.force("link",d.forceLink(this.links).id((function(t){return t.id})).iterations(data.GRAPH.iterations).distance((function(t){return t.ldis}))),d.select(this.canvas).call(d.drag().subject(this.dragsubject).on("start",this.dragstarted).on("drag",this.dragged).on("end",this.dragended)).call(d.zoom().scaleExtent([.1,8]).on("zoom",this.zoom)),this.simulation.on("tick",this.redraw)},getMousePosition:function(){var rect=this.canvas.getBoundingClientRect(),t=d.event.sourceEvent;return{x:t.clientX-rect.left,y:t.clientY-rect.top}},dragsubject:function(){for(var t=this.getMousePosition(),e=this.transform.invertX(t.x),n=this.transform.invertY(t.y),i=0;i<this.nodes.length;i++){var r=this.nodes[i],o=e-r.x,c=n-r.y;if(Math.abs(o)<3&&Math.abs(c)<3)return r.x=this.transform.applyX(r.x),r.y=this.transform.applyY(r.y),r}},dragstarted:function(){d.event.active||this.simulation.alphaTarget(.3).restart(),d.event.subject.fx=this.transform.invertX(d.event.x),d.event.subject.fy=this.transform.invertY(d.event.y)},dragged:function(){d.event.subject.fx=this.transform.invertX(d.event.x),d.event.subject.fy=this.transform.invertY(d.event.y)},dragended:function(){d.event.active||this.simulation.alphaTarget(0),d.event.subject.fx=null,d.event.subject.fy=null}},updated:function(){this.node.data.GRAPH&&this.updateGraph()},mounted:function(){var t=this;this.canvas=this.$refs.container,this.context=this.canvas.getContext("2d"),this.node.data.GRAPH&&this.updateGraph(),this.editor.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)})),this.editor.on("zoom nodetranslate",(function(){return!t.freez}))}},W=Object(O.a)(G,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node",class:t._f("kebab")([t.selected(),t.node.name])},[n("div",{staticClass:"title"},[t._v(t._s(t.node.name))]),t._v(" "),n("div",{staticClass:"node-body d-flex"},[n("div",{staticClass:"inputs"},[t._l(t.controls(),(function(t,e){return n("div",{directives:[{name:"control",rawName:"v-control",value:t,expression:"control"}],key:e,staticClass:"control"})})),t._v(" "),t._l(t.inputs(),(function(input){return n("div",{key:input.key,staticClass:"input d-flex align-center"},[n("Socket",{directives:[{name:"socket",rawName:"v-socket:input",value:input,expression:"input",arg:"input"}],attrs:{type:"input",socket:input.socket}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!input.showControl(),expression:"!input.showControl()"}],staticClass:"input-title"},[t._v(t._s(input.name))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:input.showControl(),expression:"input.showControl()"},{name:"control",rawName:"v-control",value:input.control,expression:"input.control"}],staticClass:"input-control"})],1)}))],2),t._v(" "),n("canvas",{ref:"container",attrs:{width:"500",height:"500"},on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}})])])}),[],!1,null,null,null).exports,B={mixins:[f.a.mixin],components:{Socket:f.a.Socket}},X=Object(O.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node",class:t._f("kebab")([t.selected(),t.node.name])},[n("div",{staticClass:"title"},[t._v(t._s(t.node.data.name||t.node.name))]),t._v(" "),n("div",{staticClass:"d-flex space-between"},[n("div",{},t._l(t.inputs(),(function(input){return n("div",{key:input.key,staticClass:"input d-flex align-center"},[n("Socket",{directives:[{name:"socket",rawName:"v-socket:input",value:input,expression:"input",arg:"input"}],attrs:{type:"input",socket:input.socket}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!input.showControl(),expression:"!input.showControl()"}],staticClass:"input-title"},[t._v(t._s(input.name))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:input.showControl(),expression:"input.showControl()"},{name:"control",rawName:"v-control",value:input.control,expression:"input.control"}],staticClass:"input-control"})],1)})),0),t._v(" "),n("div",t._l(t.outputs(),(function(output){return n("div",{key:output.key,staticClass:"output d-flex justify-end align-center"},[n("div",{staticClass:"output-title"},[t._v(t._s(output.name))]),t._v(" "),n("Socket",{directives:[{name:"socket",rawName:"v-socket:output",value:output,expression:"output",arg:"output"}],attrs:{type:"output",socket:output.socket}})],1)})),0)]),t._v(" "),t._l(t.controls(),(function(t){return n("div",{directives:[{name:"control",rawName:"v-control",value:t,expression:"control"}],key:t.name,staticClass:"control"})}))],2)}),[],!1,null,null,null).exports,Y={props:["placeholder","emitter","node","ikey","getData","putData"],data:function(){return{value:0,freez:!1}},methods:{plus:function(){this.value++,this.update()},minus:function(){this.value--,this.update()},freezEditor:function(t){this.freez=t},change:function(t){this.freez=!0,this.value=+t.target.value,this.update()},update:function(){this.putData(this.ikey,this.value),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.value=this.getData(this.ikey),this.emitter.on("zoom",(function(){return!t.freez})),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)}))}},H=(n(339),Object(O.a)(Y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex space-between"},[n("div",[t._v(t._s(t.ikey))]),t._v(" "),n("div",{staticClass:"d-flex align-center space-between",on:{mouseover:function(e){return t.freezEditor(!0)},mouseleave:function(e){return t.freezEditor(!1)}}},[n("div",{staticClass:"minus",on:{click:t.minus}}),t._v(" "),n("input",{attrs:{type:"number",placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.change(e)}}}),t._v(" "),n("div",{staticClass:"plus",on:{click:t.plus}})])])}),[],!1,null,null,null).exports),J={props:["options","emitter","ikey","node","getData","putData"],data:function(){return{opened:!1,value:null}},methods:{close:function(){this.opened=!1},toggle:function(){this.opened=!this.opened},change:function(option){this.value=option,this.toggle(),this.update()},update:function(){this.putData(this.ikey,this.value),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){this.value=this.getData(this.ikey)||this.options[0],this.update()}},V=(n(342),Object(O.a)(J,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex space-between"},[n("div",{staticClass:"mrr-20"},[t._v(t._s(t.ikey))]),t._v(" "),n("div",{staticClass:"dropdown fg-1",on:{mouseleave:t.close}},[n("div",{staticClass:"dropdown-control",class:{opened:t.opened},on:{click:t.toggle}},[t._v("\n      "+t._s(t.value)+"\n      "),n("div",{staticClass:"ghost"},[t._v(t._s(t.options.reduce((function(a,b){return a.length>b.length?a:b}),"")))])]),t._v(" "),t.opened?n("div",{staticClass:"dropdown-menu"},t._l(t.options,(function(option,e){return n("div",{key:e,staticClass:"dropdown-menu-item",class:{selected:option===t.value},on:{click:function(e){return t.change(option)}}},[t._v(t._s(option))])})),0):t._e()])])}),[],!1,null,null,null).exports),U={components:{Chrome:D.Chrome},props:["emitter","ikey","node","getData","putData"],data:function(){return{freez:!1,opened:!1,color:"rgba(0,0,0,250)"}},methods:{toggle:function(){this.opened=!this.opened},freezEditor:function(t){this.freez=t},updateValue:function(t){this.color="rgba(".concat(Object.values(t.rgba).toString(),")"),this.putData(this.ikey,this.color),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.putData(this.ikey,this.color),this.emitter.on("nodetranslate",(function(){return!t.freez})),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)}))}},Z=(n(344),Object(O.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"color-control",on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}},[n("svg",{attrs:{width:"40",height:"20",viewBox:"0 0 20 10"},on:{click:t.toggle}},[n("rect",{attrs:{width:"20",height:"10",fill:t.color}})]),t._v(" "),t.opened?n("div",{staticClass:"pallet"},[n("Chrome",{attrs:{value:t.color},on:{input:t.updateValue}})],1):t._e()])}),[],!1,null,null,null).exports),Q={props:["emitter","DATA","name","node","getData","putData"],data:function(){return{highlighted:!1}},methods:{highlightArea:function(t){this.highlighted=t},drop:function(t){this.highlightArea(!1),this.openFile(t.dataTransfer.files[0])},newData:function(t){var e=t.target.files[0];this.openFile(e)},openFile:function(t){var e=this,n=new FileReader;n.readAsText(t),n.onload=Object(o.a)(regeneratorRuntime.mark((function r(){var data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.name.endsWith(".csv")){r.next=6;break}return r.next=3,d.csvParse(n.result);case 3:r.t0=r.sent,r.next=7;break;case 6:r.t0=JSON.parse(n.result);case 7:data=r.t0,e.putData(e.DATA,data),e.putData(e.name,t.name),e.emitter.nodeId=e.node.id,e.emitter.trigger("process");case 12:case"end":return r.stop()}}),r)})))}},mounted:function(){var t=this;["dragenter","dragover","dragleave","drop"].forEach((function(e){t.$refs.files.addEventListener(e,(function(t){t.preventDefault(),t.stopPropagation()}),!1)}))}},K=(n(348),Object(O.a)(Q,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("label",{ref:"files",staticClass:"d-flex justify-center cursor-pointer files",class:{highlighted:t.highlighted},attrs:{for:"file"},on:{drop:function(e){return t.drop(e)},dragover:function(e){return t.highlightArea(!0)},dragleave:function(e){return t.highlightArea(!1)}}},[r("img",{staticClass:"file-type",attrs:{src:n(346)}}),t._v(" "),r("img",{staticClass:"file-type",attrs:{src:n(347)}})]),t._v(" "),r("input",{staticClass:"file-input d-flex",attrs:{id:"file",type:"file"},on:{change:t.newData}})])}),[],!1,null,null,null).exports),tt={components:{Chrome:D.Chrome},props:["emitter","ikey","node","getData","putData"],data:function(){return{colors:["rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)"),"rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)")],opened:!1,freez:!1,index:0,render:!0}},methods:{togglePallet:function(t){this.index=t,this.opened=!this.opened},freezEditor:function(t){this.freez=t},updateValue:function(t,e){this.colors[e]="rgba(".concat(Object.values(t.rgba).toString(),")"),this.render=!this.render,this.putData(this.ikey,this.colors),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.putData(this.ikey,this.colors),this.emitter.nodeId=this.node.id,this.emitter.trigger("process"),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)})),this.emitter.on("nodetranslate",(function(){return!t.freez}))}},et=(n(350),Object(O.a)(tt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"},[n("div",{staticClass:"mrr-20"},[t._v(t._s(t.ikey))]),t._v(" "),n("div",{staticClass:"fg-1",on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}},[n("svg",{staticStyle:{"margin-right":"20px"},attrs:{height:"25",viewBox:"0 0 20 20"},on:{click:function(e){return t.togglePallet(0)}}},[n("circle",{attrs:{cx:"10",cy:"10",r:"10",fill:t.colors[0]}})]),t._v(" "),n("svg",{attrs:{height:"25",viewBox:"0 0 20 20"},on:{click:function(e){return t.togglePallet(1)}}},[n("circle",{attrs:{cx:"10",cy:"10",r:"10",fill:t.colors[1]}})]),t._v(" "),t.opened?n("div",{staticClass:"pallet"},[n("Chrome",{attrs:{value:t.colors[t.index]},on:{input:function(e){return t.updateValue(e,t.index)}}})],1):t._e(),t._v(" "),n("div",{staticStyle:{visibility:"hidden",height:"0"}},[t._v(t._s(t.render))])])])}),[],!1,null,null,null).exports),nt={props:["emitter","ikey","range","node","getData","putData"],components:{Chrome:D.Chrome},data:function(){return{drag:!1,render:!1,freez:!1,positions:[0,1],index:0}},methods:{short:function(t){return(t=t.toString()).length<4?t:t.slice(0,-3)+"K"},togglePallet:function(t){this.render=!this.render},dragStart:function(t){this.index=t,this.freezEditor(!0),this.drag=!0},dragEnd:function(){this.freezEditor(!1),this.drag=!1},dragging:function(t){if(this.drag){var e=this.$refs.slider.getBoundingClientRect(),n=e.right-e.left,r=(t.clientX-e.left)/n,o=this.positions[this.index+1]||1,c=this.positions[this.index-1]||0;r<o&&r>c&&(this.positions[this.index]=r,this.render=!this.render,this.update())}},freezEditor:function(t){this.freez=t},update:function(){var t=this.range[1]-this.range[0];this.putData(this.ikey,[this.range[0]+t*this.positions[0],this.range[0]+t*this.positions[1]]),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;document.addEventListener("mouseup",this.dragEnd),this.update(),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)})),this.emitter.on("nodetranslate",(function(){return!t.freez}))}},at=Object(O.a)(nt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex space-between range-control"},[n("div",[t._v(t._s(t.ikey))]),t._v(" "),n("div",{staticClass:"relative range-selector"},[n("div",{staticClass:"min"},[t._v(t._s(t.short(t.range[0])))]),t._v(" "),n("div",{staticClass:"container ",on:{mousemove:function(e){return t.dragging(e)}}},[n("div",{ref:"slider",staticClass:"slider d-flex"},[n("svg",{staticClass:"circle",style:{left:90*t.positions[0]+"%"},attrs:{height:"20",viewBox:"0 0 10 10"},on:{mousedown:function(e){return t.dragStart(0)}}},[n("circle",{attrs:{cx:"5",cy:"5",r:"5"}})]),t._v(" "),n("svg",{staticClass:"circle",style:{left:90*t.positions[1]+"%"},attrs:{height:"20",viewBox:"0 0 10 10"},on:{mousedown:function(e){return t.dragStart(1)}}},[n("circle",{attrs:{cx:"5",cy:"5",r:"5"}})]),t._v(" "),n("div",{style:{visibility:"hidden"}},[t._v(t._s(t.render))])])]),t._v(" "),n("div",{staticClass:"max"},[t._v(t._s(t.short(t.range[1])))])])])}),[],!1,null,null,null).exports,ot=(n(120),{props:["placeholder","readonly","emitter","ikey","node","getData","putData"],data:function(){return{loading:!1}},methods:{update:function(t){var e=this,n=t.target.value;(n.endsWith(".csv")||n.endsWith(".json")||n.endsWith(".geojson"))&&(this.loading=!0,n=n.startsWith("https")?n:"https://"+n,Object(d.text)(n).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(r){var data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.endsWith(".csv")){t.next=6;break}return t.next=3,Object(d.csvParse)(r);case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=JSON.parse(r);case 7:data=t.t0,node.data.name=n.split("/").pop(),node.data.data=data,e.emitter.nodeId=e.node.id,e.emitter.trigger("process");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.loading=!1})))}}}),it=(n(353),Object(O.a)(ot,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.loading?r("img",{attrs:{src:n(352)}}):r("div",{staticClass:"d-flex"},[r("div",{staticClass:"mrr-20"},[t._v(t._s(t.placeholder))]),t._v(" "),r("input",{attrs:{type:"string",readonly:t.readonly,placeholder:t.placeholder},on:{input:function(e){return t.update(e)},dblclick:function(t){t.stopPropagation()},pointerdown:function(t){t.stopPropagation()},pointermove:function(t){t.stopPropagation()}}})])])}),[],!1,null,null,null).exports),st={props:["emitter","ikey","range","node","getData","putData"],components:{Chrome:D.Chrome},data:function(){return{drag:!1,render:!1,freez:!1,position:1,index:0}},methods:{short:function(t){return(t=t.toString()).length<4?t:t.slice(0,-3)+"K"},dragStart:function(){this.freezEditor(!0),this.drag=!0},dragEnd:function(){this.freezEditor(!1),this.drag=!1},dragging:function(t){if(this.drag){var e=this.$refs.slider.getBoundingClientRect(),n=e.right-e.left,r=(t.clientX-e.left)/n;r<1&&r>0&&(this.position=r,this.update())}},freezEditor:function(t){this.freez=t},update:function(){var t=this.range[1]-this.range[0];this.putData(this.ikey,this.range[0]+t*this.position),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.position=this.getData(this.ikey)||this.position,document.addEventListener("mouseup",this.dragEnd),this.update(),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)})),this.emitter.on("nodetranslate",(function(){return!t.freez}))}},ct=Object(O.a)(st,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex space-between range-control"},[n("div",[t._v(t._s(t.ikey))]),t._v(" "),n("div",{staticClass:"relative range-selector"},[n("div",{staticClass:"min"},[t._v(t._s(t.short(t.range[0])))]),t._v(" "),n("div",{staticClass:"container mrr-20",on:{mousemove:function(e){return t.dragging(e)}}},[n("div",{ref:"slider",staticClass:"slider d-flex"},[n("svg",{staticClass:"circle",style:{left:90*t.position+"%"},attrs:{height:"20",viewBox:"0 0 10 10"},on:{mousedown:t.dragStart}},[n("circle",{attrs:{cx:"5",cy:"5",r:"5"}})])])]),t._v(" "),n("div",{staticClass:"max"},[t._v(t._s(t.short(t.range[1])))])])])}),[],!1,null,null,null).exports,ut={props:["emitter","ikey","label","node","getData","putData"],data:function(){return{freez:!1,value:!1}},watch:{value:function(){this.update()}},methods:{freezEditor:function(t){this.freez=t},change:function(){this.value=!this.value,this.update()},update:function(){this.putData(this.ikey,this.value),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.value=this.getData(this.ikey)||this.value,this.update(),this.emitter.on("zoom",(function(){return!t.freez})),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)}))}},lt=(n(355),Object(O.a)(ut,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"d-flex align-center",on:{mouseover:function(e){return t.freezEditor(!0)},mouseleave:function(e){return t.freezEditor(!1)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{change:function(e){var n=t.value,r=e.target,o=!!r.checked;if(Array.isArray(n)){var c=t._i(n,null);r.checked?c<0&&(t.value=n.concat([null])):c>-1&&(t.value=n.slice(0,c).concat(n.slice(c+1)))}else t.value=o}}}),t._v(" "),n("div",{staticClass:"checkmark"}),t._v("\n  "+t._s(t.label)+"\n")])}),[],!1,null,null,null).exports),ht={components:{Chrome:D.Chrome},props:["emitter","ikey","node","getData","putData"],data:function(){return{colors:["rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)"),"rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)")],opened:!1,index:null,freez:!1}},computed:{width:function(){return 100/this.colors.length+"%"}},methods:{remove:function(t){this.opened=!1,this.index=null,this.colors.splice(t,1)},addColor:function(){var t="rgba(".concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",").concat(Math.floor(256*Math.random()),",1)");this.colors.push(t),this.update()},togglePallet:function(t){if(t===this.index)return this.opened=!1,void(this.index=null);this.index=t,this.opened=!0},freezEditor:function(t){this.freez=t},updateValue:function(t){this.colors[this.index]="rgba(".concat(Object.values(t.rgba).toString(),")"),this.update()},update:function(){this.putData(this.ikey,this.colors),this.emitter.nodeId=this.node.id,this.emitter.trigger("process")}},mounted:function(){var t=this;this.update(),this.emitter.on("nodetranslate zoom",(function(){return!t.freez})),this.emitter.on("noderemove",(function(e){e.id===t.node.id&&(t.freez=!1)}))}},pt=(n(357),Object(O.a)(ht,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex relative align-center",on:{mouseover:function(e){return t.freezEditor(!0)},mouseout:function(e){return t.freezEditor(!1)}}},[t._l(t.colors,(function(e,i){return n("div",{key:i,staticClass:"trigger",style:{background:e,width:t.width},on:{dblclick:function(e){return t.remove(i)},click:function(e){return t.togglePallet(i)}}})})),t._v(" "),n("div",{staticClass:"add-color",on:{click:t.addColor}}),t._v(" "),t.opened?n("div",{staticClass:"color-pallet"},[n("Chrome",{attrs:{value:t.colors[t.index]},on:{input:t.updateValue}})],1):t._e()],2)}),[],!1,null,null,null).exports),ft=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=K,c.props={emitter:t,DATA:n,name:r,node:o},c}return Object(k.a)(e,t),e}(l.c.Control),vt=function(t){function e(t,n,r){var o;return Object(m.a)(this,e),(o=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",o.component=Z,o.props={emitter:t,ikey:n,node:r},o}return Object(k.a)(e,t),e}(l.c.Control),gt=(l.c.Control,l.c.Control,function(t){function e(t,n,r){var o;return Object(m.a)(this,e),(o=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",o.component=pt,o.props={emitter:t,ikey:n,node:r},o}return Object(k.a)(e,t),e}(l.c.Control)),mt=function(t){function e(t,n,label,r){var o;return Object(m.a)(this,e),(o=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",o.component=lt,o.props={emitter:t,ikey:n,label:label,node:r},o}return Object(k.a)(e,t),e}(l.c.Control),yt=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=ct,c.props={emitter:t,ikey:n,range:r,node:o},c}return Object(k.a)(e,t),e}(l.c.Control),wt=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=at,c.props={emitter:t,ikey:n,range:r,node:o},c}return Object(k.a)(e,t),e}(l.c.Control),xt=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=H,c.props={emitter:t,ikey:n,node:r,placeholder:o},c}return Object(k.a)(e,t),Object(y.a)(e,[{key:"setValue",value:function(t){this.vueContext.value=t}}]),e}(l.c.Control),bt=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=it,c.props={emitter:t,ikey:n,placeholder:r,node:o},c}return Object(k.a)(e,t),e}(l.c.Control),kt=function(t){function e(t,n,r,o){var c;return Object(m.a)(this,e),(c=Object(w.a)(this,Object(x.a)(e).call(this,n))).render="vue",c.component=V,c.props={emitter:t,ikey:n,options:r,node:o},c}return Object(k.a)(e,t),Object(y.a)(e,[{key:"setValue",value:function(t){this.vueContext.value=t}}]),e}(l.c.Control);function Ct(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function Ot(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Ct(Object(source),!0).forEach((function(e){Object(v.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):Ct(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var jt=new l.c.Socket("Color"),_t=new l.c.Socket("Layer"),It=new l.c.Socket("Data"),zt=new l.c.Socket("HeatMap"),Mt=new l.c.Socket("Force X"),St=new l.c.Socket("Force Y"),Nt=new l.c.Socket("Force Many Body"),Et=new l.c.Socket("Force Radial"),Rt=new l.c.Socket("Links"),At=new l.c.Socket("Point Geometry"),Pt=new l.c.Socket("Line Geometry"),Dt=new l.c.Socket("Polygon Geometry"),Lt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Multiply"))).data.component=X,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.data.multiplier=1,t.addInput(new l.c.Input("nums","Nums",It)).addOutput(new l.c.Output("result","Result",It)).addControl(new xt(this.editor,"multiplier",t))}},{key:"worker",value:function(t,e,n){n.result=e.nums[0].map((function(e){return isNaN(+e)?e:e*t.data.multiplier}))}}]),e}(l.c.Component),Ft=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Color"))).data.component=$,t.path=[],t}var n;return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.colors=t.data.colors||{};var e=new l.c.Input("values","Values",It);e.addControl(new vt(this.editor,"color",t)),t.addInput(e).addOutput(new l.c.Output("colors","Colors",jt))}},{key:"worker",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(e,n,r){var data,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((data=e.data).values=n.values.length?Object(c.a)(new Set(n.values[0])):[],data.values.length){t.next=5;break}return r.colors={value:data.color},t.abrupt("return");case 5:data.values.length>12&&(data.values=d.extent(data.values)),this.editor.nodes.find((function(t){return t.id===e.id})).update(),o=data.colors,l=d.scaleLinear(d.extent(data.values),Object.values(o)),r.colors={data:n.values[0].map((function(t){return isNaN(t)?o[t]:l(t)})),value:null,colors:o};case 10:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})}]),e}(l.c.Component),Tt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Parse"))).data.component=X,t.path=null,t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){if("FeatureCollection"===t.data.data.type){var e=t.data.data.features[0];for(var n in e.properties)t.addOutput(new l.c.Output(n,n,It));var r=e.geometry.type,o="Point"===r?At:"LineString"===r?Pt:Dt;t.addOutput(new l.c.Output("geom","Geometry",o))}else for(var c in t.data.data[0])t.addOutput(new l.c.Output(c,c,It))}},{key:"worker",value:function(t,e,n){if("FeatureCollection"===t.data.data.type){var r=t.data.data.features[0].properties,o=function(e){n[e]=t.data.data.features.map((function(t){return t.properties[e]}))};for(var c in r)o(c);n.geom=t.data.data.features.map((function(t){return t.geometry}))}else{var d=function(e){n[e]=t.data.data.map((function(t){return isNaN(+t[e])?t[e]:+t[e]}))};for(var l in t.data.data[0])d(l)}}}]),e}(l.c.Component),$t=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Dataset"))).data.component=X,t.path=[],t}var n;return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.data.dataset="",t.addControl(new kt(this.editor,"dataset",["","cars","sea-ice","branches","arcs","nodes","links"],t)).addControl(new bt(this.editor,"url","Url",t)).addControl(new ft(this.editor,"data","name",t))}},{key:"worker",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(e,n,r,c){var data,component,l,h=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.data.dataset&&(data={name:e.data.dataset,data:c.data[e.data.dataset]}),e.data.data&&(data={name:e.data.name,data:e.data.data}),!data){t.next=17;break}if("FeatureCollection"!=data.data.type){t.next=7;break}d.nest().key((function(t){return t.geometry.type})).entries(data.data.features).forEach(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(n,i){var component,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return component=new Tt,t.next=3,component.createNode({name:name,data:{type:"FeatureCollection",features:n.values}});case 3:(r=t.sent).position=[e.position[0],e.position[1]+20*i],h.editor.addNode(r),h.editor.nodeId=r.id,h.editor.trigger("process");case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),t.next=15;break;case 7:return component=new Tt,t.next=10,component.createNode(data);case 10:(l=t.sent).position=e.position,this.editor.addNode(l),this.editor.nodeId=l.id,this.editor.trigger("process");case 15:this.editor.removeNode(this.editor.nodes.find((function(t){return t.id===e.id})));case 17:case"end":return t.stop()}}),t,this)}))),function(t,e,r,o){return n.apply(this,arguments)})}]),e}(l.c.Component),Gt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Range"))).data.component=X,t.path=[],t}var n;return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.addInput(new l.c.Input("nums","Values",It)),t.data.values&&t.addControl(new wt(this.editor,"domain",[t.data.domainFrom,t.data.domainTo],t)).addControl(new wt(this.editor,"range",[1,30],t)).addOutput(new l.c.Output("range","Range",It))}},{key:"worker",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(e,n,r){var o,d,l,h,f,v,component,m,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.data.values&&(o=e.data.domain[0],d=e.data.domain[1],l=e.data.range[0],h=e.data.range[1],r.range=n.nums[0].map((function(t){return((t=(t=t>d?d:t)<o?o:t)-o)*(h-l)/(d-o)+l})),JSON.stringify(e.data.values)!=JSON.stringify(n.nums[0])&&(e.data.values=null)),e.data.values||!n.nums.length){t.next=13;break}return f=n.nums[0],v=e.inputs.nums.connections[0],component=this.editor.components.get("Range"),t.next=7,component.createNode({values:f,domainFrom:Math.min.apply(Math,Object(c.a)(f)),domainTo:Math.max.apply(Math,Object(c.a)(f))});case 7:(m=t.sent).position=e.position,this.editor.addNode(m),y=this.editor.nodes.find((function(t){return t.id===v.node})),this.editor.connect(y.outputs.get(v.output),m.inputs.get("nums")),this.editor.removeNode(this.editor.nodes.find((function(t){return t.id===e.id})));case 13:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})}]),e}(l.c.Component),Wt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Point Layer"))).data.component=X,t.path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.radius=100;var e=new l.c.Input("radius","Radius",It);e.addControl(new xt(this.editor,"radius",t,"radius")),t.addInput(new l.c.Input("lat","Lat",It)).addInput(new l.c.Input("lon","Lon",It)).addInput(new l.c.Input("geometry","Geometry",At)).addInput(new l.c.Input("colors","Color",jt)).addInput(e).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.lat.length&&e.lon.length||e.geometry.length){var data=[];e.lat.length&&e.lon.length&&e.lat[0].length===e.lon[0].length?data={type:"FeatureCollection",features:e.lat[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.radius.length?{radius:e.radius[0][i]}:{},{},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{}),geometry:{type:"Point",coordinates:[e.lon[0][i],e.lat[0][i]]}}}))}:e.geometry.length&&(data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.radius.length?{radius:e.radius[0][i]}:{},{},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{}),geometry:g}}))}),n.layer={type:"point",data:data,radius:e.radius.length?null:t.data.radius,color:e.colors.length?e.colors[0].value:"rgba(160, 160, 180, 250)"}}}}]),e}(l.c.Component),Bt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Line Layer"))).data.component=X,t.path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.addInput(new l.c.Input("x","X",It)).addInput(new l.c.Input("x1","X1",It)).addInput(new l.c.Input("y","Y",It)).addInput(new l.c.Input("y1","Y1",It)).addInput(new l.c.Input("geometry","Geometry",Pt)).addInput(new l.c.Input("colors","Color",jt)).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.x.length&&e.y.length&&e.x1.length&&e.y1.length||e.geometry.length){var data=[];e.x.length&&e.y.length&&e.x1.length&&e.y1.length&&e.x[0].length===e.y[0].length&&e.x[0].length===e.x1[0].length&&e.x[0].length===e.y1[0].length?data={type:"FeatureCollection",features:e.x[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{}),geometry:{type:"LineString",coordinates:[[e.x[0][i],e.y[0][i]],[e.x1[0][i],e.y1[0][i]]]}}}))}:e.geometry.length&&(data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{}),geometry:g}}))}),n.layer={type:"line",data:data,color:e.colors.length?e.colors[0].value:"rgba(160, 160, 180, 250)"}}}}]),e}(l.c.Component),Xt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Arc Layer"))).data.component=X,t.path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.width=2;var e=new l.c.Input("width","Width",It);e.addControl(new xt(this.editor,"width",t,"width")),t.addInput(new l.c.Input("x","X",It)).addInput(new l.c.Input("x1","X1",It)).addInput(new l.c.Input("y","Y",It)).addInput(new l.c.Input("y1","Y1",It)).addInput(new l.c.Input("geometry","Geometry",Pt)).addInput(new l.c.Input("colors","Color",jt)).addInput(e).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.x.length&&e.y.length&&e.x1.length&&e.y1.length||e.geometry.length){var data=[];console.log(e.colors),e.x.length&&e.y.length&&e.x1.length&&e.y1.length&&e.x[0].length===e.y[0].length&&e.x[0].length===e.x1[0].length&&e.x[0].length===e.y1[0].length?data={type:"FeatureCollection",features:e.x[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{},{},e.width.length?{width:e.width[0][i]}:{}),geometry:{type:"LineString",coordinates:[[e.x[0][i],e.y[0][i]],[e.x1[0][i],e.y1[0][i]]]}}}))}:e.geometry.length&&(data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{},{},e.width.length?{width:e.width[0][i]}:{}),geometry:g}}))}),n.layer={type:"arc",data:data,width:e.width.length?null:t.data.width,color:e.colors.length?e.colors[0].value:"rgba(160, 160, 180, 250)"}}}}]),e}(l.c.Component),Yt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Polygon Layer"))).data.component=X,t.path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.height=30;var e=new l.c.Input("height","Height",It);e.addControl(new xt(this.editor,"height",t,"height")),t.addControl(new kt(this.editor,"shape",["extrude","fill"],t)).addInput(new l.c.Input("colors","Colors",jt)).addInput(e).addInput(new l.c.Input("geometry","Geometry",Dt)).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.geometry.length){var data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.colors.length&&e.colors[0].data?{color:e.colors[0].data[i]}:{},{},e.height.length?{height:e.height[0][i]}:{}),geometry:g}}))};n.layer={type:"polygon",data:data,extruded:"extrude"===t.data.shape,color:e.colors.length?e.colors[0].value:"rgba(160, 160, 180, 250)",height:e.height.length?null:t.data.height}}}}]),e}(l.c.Component),Ht=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"GridMap Layer"))).data.component=X,t.path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.extruded=!0,t.addControl(new kt(this.editor,"type",["hexagon","grid"],t)).addControl(new mt(this.editor,"extruded","Extrude",t)).addControl(new gt(this.editor,"colorRange",t)).addControl(new wt(this.editor,"elevationRange",[0,2e5],t)).addControl(new kt(this.editor,"colorAggMethod",["SUM","MEAN","MIN","MAX"],t)).addControl(new kt(this.editor,"elevationAggMethod",["SUM","MEAN","MIN","MAX"],t)).addInput(new l.c.Input("lat","Lat",It)).addInput(new l.c.Input("lon","Lon",It)).addInput(new l.c.Input("geometry","Geometry",At)).addInput(new l.c.Input("elevation","Elevation",It)).addInput(new l.c.Input("color","Color",It)).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.lat.length&&e.lon.length||e.geometry.length){var data=[];e.lat.length&&e.lon.length&&e.lat[0].length===e.lon[0].length?data={type:"FeatureCollection",features:e.lat[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.elevation.length?{elevation:e.elevation[0][i]}:{},{},e.color.length?{color:e.color[0][i]}:{}),geometry:{type:"Point",coordinates:[e.lon[0][i],e.lat[0][i]]}}}))}:e.geometry.length&&(data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.elevation.length?{elevation:e.elevation[0][i]}:{},{},e.color.length?{color:e.color[0][i]}:{}),geometry:g}}))}),n.layer={type:"hexagon",grid_type:t.data.type,extruded:t.data.extruded,colorRange:t.data.colorRange,elevationRange:t.data.elevationRange,colorAggMethod:t.data.colorAggMethod,elevationAggMethod:t.data.elevationAggMethod,data:data}}}}]),e}(l.c.Component),Jt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"HeatMap Layer"))).path=["Layers"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"build",value:function(t){t.data.weight=30;var e=new l.c.Input("weight","Weight",It);e.addControl(new xt(this.editor,"weight",t,"weight")),t.addInput(new l.c.Input("lat","Lat",It)).addInput(new l.c.Input("lon","Lon",It)).addInput(new l.c.Input("geometry","Geometry",At)).addInput(e).addInput(new l.c.Input("heatmap","Heatmap",zt)).addOutput(new l.c.Output("layer","Layer",_t))}},{key:"worker",value:function(t,e,n){if(e.lat.length&&e.lon.length||e.geometry.length){var data={};e.lat.length&&e.lon.length&&e.lat[0].length===e.lon[0].length?data={type:"FeatureCollection",features:e.lat[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.weight.length?{weight:e.weight[0][i]}:{}),geometry:{type:"Point",coordinates:[e.lon[0][i],e.lat[0][i]]}}}))}:e.geometry.length&&(data={type:"FeatureCollection",features:e.geometry[0].map((function(g,i){return{type:"Feature",properties:Ot({},e.weight.length?{weight:e.weight[0][i]}:{}),geometry:g}}))}),n.layer={type:"heatmap",data:data,weight:e.weight.length?null:t.data.weight,radius:e.heatmap.length?e.heatmap[0].radius:null,intensity:e.heatmap.length?e.heatmap[0].intensity:null,threshold:e.heatmap.length?e.heatmap[0].threshold:null,colorRange:e.heatmap.length?e.heatmap[0].colors:null}}}}]),e}(l.c.Component),Vt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"HeatMap"))).data.component=X,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.data.threshold=.2,t.addControl(new xt(this.editor,"intensity",t,"intensity")).addControl(new xt(this.editor,"radius",t,"radius")).addControl(new yt(this.editor,"threshold",[0,1],t)).addControl(new gt(this.editor,"colors",t)).addOutput(new l.c.Output("heatmap","HeapMap",zt))}},{key:"worker",value:function(t,e,n){n.heatmap={intensity:t.data.intensity,radius:t.data.radius,threshold:t.data.threshold,colors:t.data.colors}}}]),e}(l.c.Component),Ut=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Map"))).data.component=P,t.data.render="vue",t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.addInput(new l.c.Input("layer0","layer",_t));var e=t.data.inputs;e&&e.forEach((function(input){return t.addInput(new l.c.Input(input,input,_t))}))}},{key:"worker",value:function(t,e,n,r){t.data.id||(r.maps++,t.data.id=r.maps),t.data.layers=Object.values(e).map((function(input){return input[0]})).filter((function(t){return t}));var o=r.preview.find((function(e){return e.id===t.data.id}));t.data.preview?o?(o.name=t.data.name,o.layers=t.data.layers):r.preview.push({id:t.data.id,name:t.data.name,layers:t.data.layers}):o&&r.preview.splice(r.preview.indexOf(o),1),t.data.update=!0,this.editor.nodes.find((function(e){return e.id===t.id})).update()}}]),e}(l.c.Component),Zt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Scatter"))).data.component=j,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.addInput(new l.c.Input("x","X",It)).addInput(new l.c.Input("y","Y",It)).addInput(new l.c.Input("colors","Colors",jt)).addInput(new l.c.Input("size","Size",It))}},{key:"worker",value:function(t,e,n){e.x.length&&e.y.length&&(t.data.type="point",t.data.DATA=e.x[0].map((function(t,i){return Ot({x:e.x[0][i],y:e.y[0][i]},e.colors.length?e.colors[0].data?{color:e.colors[0].data[i]}:{color:e.colors[0].value}:{},{},e.size.length?{size:+e.size[0][i]}:{})}))),this.editor.nodes.find((function(e){return e.id===t.id})).update()}}]),e}(l.c.Component),Qt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Line"))).data.component=j,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.addInput(new l.c.Input("x","X",It)).addInput(new l.c.Input("y","Y",It)).addInput(new l.c.Input("i","Index",It)).addInput(new l.c.Input("color","Colors",jt))}},{key:"worker",value:function(t,e,n){e.x.length&&e.y.length&&(t.data.type="line",t.data.DATA=e.x[0].map((function(t,i){return{x:e.x[0][i],y:e.y[0][i],index:e.i.length?e.i[0][i]:0}})),t.data.colors=e.color.length?e.color[0].colors||[e.color[0].value]:["#e3c000"]),this.editor.nodes.find((function(e){return e.id===t.id})).update()}}]),e}(l.c.Component),Kt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Force Many Body"))).data.component=X,t.path=["Force"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){var e=new l.c.Input("strength","Strength",It);e.addControl(new yt(this.editor,"strength",[-30,30],t)),t.addInput(e).addOutput(new l.c.Output("force","Force",Nt))}},{key:"worker",value:function(t,e,n){n.force={strength:e.strength.length?e.strength[0]:t.data.strength}}}]),e}(l.c.Component),qt=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Force Radial"))).data.component=X,t.path=["Force"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){var e=new l.c.Input("strength","Strength",It);e.addControl(new yt(this.editor,"strength",[0,1],t));var n=new l.c.Input("radius","Radius",It);n.addControl(new yt(this.editor,"radius",[0,250],t)),t.addInput(e).addInput(n).addControl(new yt(this.editor,"x",[0,500],t)).addControl(new yt(this.editor,"y",[0,500],t)).addOutput(new l.c.Output("force","Force",Et))}},{key:"worker",value:function(t,e,n){n.force={strength:e.strength.length?e.strength[0]:t.data.strength,radius:e.radius.length?e.radius[0]:t.data.radius,center:[t.data.x,t.data.y]}}}]),e}(l.c.Component),te=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Force X"))).data.component=X,t.path=["Force"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){var e=new l.c.Input("strength","Strength",It);e.addControl(new yt(this.editor,"strength",[-1,1],t));var n=new l.c.Input("x","X",It);n.addControl(new yt(this.editor,"x",[0,500],t)),t.addInput(e).addInput(n).addOutput(new l.c.Output("force","Force",Mt))}},{key:"worker",value:function(t,e,n){n.force={strength:e.strength.length?e.strength[0]:t.data.strength,x:e.x.length?e.x[0]:t.data.x}}}]),e}(l.c.Component),ee=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Force Y"))).data.component=X,t.path=["Force"],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){var e=new l.c.Input("strength","Strength",It);e.addControl(new yt(this.editor,"strength",[-1,1],t));var n=new l.c.Input("y","Y",It);n.addControl(new yt(this.editor,"y",[0,500],t)),t.addInput(e).addInput(n).addOutput(new l.c.Output("force","Force",St))}},{key:"worker",value:function(t,e,n){n.force={strength:e.strength.length?e.strength[0]:t.data.strength,y:e.y.length?e.y[0]:t.data.y}}}]),e}(l.c.Component),ne=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Links"))).data.component=X,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){var e=new l.c.Input("distance","Distance",It);e.addControl(new yt(this.editor,"distance",[0,100],t)),t.addInput(new l.c.Input("source","source",It)).addInput(new l.c.Input("target","target",It)).addControl(new yt(this.editor,"iterations",[1,10],t)).addInput(e).addOutput(new l.c.Output("links","Links",Rt))}},{key:"worker",value:function(t,e,n){e.source.length&&e.target.length&&(n.links={iterations:t.data.iterations,links:e.source.map((function(n,i){return{source:n,target:e.target[0][i],ldis:e.distance.length?e.distance[i]:t.data.distance}}))})}}]),e}(l.c.Component),re=function(t){function e(){var t;return Object(m.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,"Graph"))).data.component=W,t.path=[],t}return Object(k.a)(e,t),Object(y.a)(e,[{key:"builder",value:function(t){t.data.radius=10;var e=new l.c.Input("radius","Radius",It);e.addControl(new xt(this.editor,"radius",t,"radius")),t.addInput(new l.c.Input("id","id",It)).addInput(new l.c.Input("x","Force X",Mt)).addInput(new l.c.Input("y","Force Y",St)).addInput(new l.c.Input("charge","Force Many Body",Nt)).addInput(new l.c.Input("radial","Force Radial",Et)).addInput(new l.c.Input("colors","Colors",jt)).addInput(e).addInput(new l.c.Input("links","Links",Rt))}},{key:"worker",value:function(t,e,n){e.id.length?t.data.GRAPH=Ot({radialCenter:e.radial.length?e.radial[0].center:[],iterations:e.links.length?e.links[0].iterations:null},e.links.length?{links:e.links[0].links}:{},{nodes:e.id[0].map((function(n,i){return Ot({id:n,radius:e.radius.length?e.radius[0][i]:t.data.radius||null},e.colors.length?e.colors[0].data?{color:e.colors[0].data[i]}:{color:e.colors[0].value}:{color:null},{},e.x.length?e.x[0].strength.length?{xstr:e.x[0].strength[i]}:{xstr:e.x[0].strength}:{xstr:null},{},e.x.length?e.x[0].x.length?{xpos:e.x[0].x[i]}:{xpos:e.x[0].x}:{xpos:null},{},e.y.length?e.y[0].strength.length?{ystr:e.y[0].strength[i]}:{ystr:e.y[0].strength}:{ystr:null},{},e.y.length?e.y[0].y.length?{ypos:e.y[0].y[i]}:{ypos:e.y[0].y}:{ypos:null},{},e.charge.length?e.charge[0].strength.length?{cstr:e.charge[0].strength[i]}:{cstr:e.charge[0].strength}:{cstr:null},{},e.radial.length?e.radial[0].strength.length?{rstr:e.radial[0].strength[i]}:{rstr:e.radial[0].strength}:{rstr:null},{},e.radial.length?e.radial[0].radius.length?{rad:e.radial[0].radius[i]}:{rad:e.radial[0].radius}:{rad:null},{},e.radial.length?e.radial[0].radius.length?{rad:e.radial[0].radius[i]}:{rad:e.radial[0].radius}:{rad:null})}))}):t.data.GRAPH=null,this.editor.nodes.find((function(e){return e.id===t.id})).update()}}]),e}(l.c.Component),ae=(n(359),function(){function t(e){var n=this;Object(m.a)(this,t),this.components=new Map,e.forEach((function(component){return n.components.set(component.name,component)})),this.editor=null,this.args=null,this.nodes={}}var e,n;return Object(y.a)(t,[{key:"processNode",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,component,r,o,d,l,h,f,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.nodes[e.id])||(n=this.nodes[e.id]={id:e.id}),!n.visited){t.next=4;break}return t.abrupt("return");case 4:for(o in n.visited=!0,component=this.components.get(e.name),r={},e.inputs)(d=e.inputs[o].connections[0])?(l=this.nodes[d.node],r[o]=[l.outputs[d.output]]):r[o]=[];return n.outputs={},t.next=11,component.worker.apply(component,[e,r,n.outputs].concat(Object(c.a)(this.args)));case 11:t.t0=regeneratorRuntime.keys(e.outputs);case 12:if((t.t1=t.t0()).done){t.next=21;break}if(h=t.t1.value,!(f=e.outputs[h].connections[0])){t.next=19;break}return v=this.editor.nodes[f.node],t.next=19,this.processNode(v);case 19:t.next=12;break;case 21:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"process",value:(e=Object(o.a)(regeneratorRuntime.mark((function t(e,n){var r,o,c,d,l,h=this,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=f.length,o=new Array(r>2?r-2:0),c=2;c<r;c++)o[c-2]=f[c];for(d in this.args=o,this.nodes)this.nodes[d].visited=!1;if(n){t.next=6;break}return Object.values(e.nodes).forEach((function(t){return h.processNode(t)})),t.abrupt("return");case 6:return this.editor=e,l=this.editor.nodes[n],t.next=10,this.processNode(l);case 10:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})}]),t}()),oe={data:function(){return{deck:null,viewState:{latitude:59.92,longitude:30.29,zoom:9,pitch:0,bearing:0},selectedId:0,href:"",download:"export.json",editor:null,engine:null,state:{preview:[],maps:0,data:{}},copiedNode:null,errorMsg:!1,msg:null,showMenu:!1,menu:[0,0],hoveredComp:null,searched:null,node:!1}},computed:{preview:function(){return this.state.preview},components:function(){var t=this,menu=[],e=Object(c.a)(this.editor.components.values());return e.forEach((function(e){if(e.path)if(t.searched)e.name.toLowerCase().includes(t.searched.toLowerCase())&&menu.push({name:e.name});else if(e.path.length){var n=menu.find((function(t){return t.name===e.path[0]}));n?n.children.push({name:e.name}):menu.push({name:e.path[0],children:[{name:e.name}]})}else menu.push({name:e.name})})),menu}},watch:{preview:{deep:!0,handler:function(t){t.length&&this.drawMap()}}},methods:{openSideMenu:function(component,t){component.children&&t&&(this.hoveredComp=component.name),t||(this.hoveredComp=null)},createNode:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var component,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.children){n.next=8;break}return component=e.editor.components.get(t.name),n.next=4,component.createNode();case 4:(r=n.sent).position=e.menu,e.editor.addNode(r),e.showMenu=!1;case 8:case"end":return n.stop()}}),n)})))()},load:function(t){var e=this,n=t.target.files[0];if(n){var c=new FileReader;c.readAsText(n),c.onload=Object(o.a)(regeneratorRuntime.mark((function t(){var data,n,o,i,d,l,h,component,f,v,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(data=JSON.parse(c.result),n=e.editor.nodes,o=n.length,i=0;i<o;i++)e.editor.removeNode(n[0]);d=Object.values(data.nodes),l=0;case 6:if(!(l<d.length)){t.next=18;break}return h=d[l],component=e.editor.components.get(h.name),t.next=11,component.createNode(h.data);case 11:(f=t.sent).id=h.id,f.position=h.position,e.editor.addNode(f);case 15:l++,t.next=6;break;case 18:for(v=function(t){var n=d[t],o=e.editor.nodes.find((function(t){return t.id===n.id}));Object.entries(n.inputs).forEach((function(t){var n=Object(r.a)(t,2),c=n[0],d=n[1];if(d.connections.length){var l=d.connections[0],h=e.editor.nodes.find((function(t){return t.id===l.node}));e.editor.connect(h.outputs.get(l.output),o.inputs.get(c))}}))},m=0;m<d.length;m++)v(m);e.editor.nodeId=void 0,e.editor.trigger("process");case 22:case"end":return t.stop()}}),t)})))}},select:function(t){this.selectedId=t,this.drawMap()},saveEditor:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,data,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.editor.toJSON();case 2:r=n.sent,data=JSON.stringify(r,null," "),o=new Blob([data],{type:"application/json"}),e.href=URL.createObjectURL(o),(!t||t instanceof MouseEvent)&&(e.msg="Content saved!"),setTimeout((function(){e.msg=null}),1e3);case 8:case"end":return n.stop()}}),n)})))()},drawMap:function(){var t=this,e=this.state.preview[this.selectedId].layers;if(e){var n=[];e.forEach((function(e){var r,o=function(n){return t.strToRGBA(e.color||n.properties.color)};switch(e.type){case"hexagon":r=new N.a({data:e.data.features,getPosition:function(t){return t.geometry.coordinates},extruded:!0,elevationScale:5,getElevationWeight:function(t){return t.properties.elevation||1},getColorWeight:function(t){return t.properties.color||1}});break;case"heatmap":r=new R.a({data:e.data.features,getPosition:function(t){return t.geometry.coordinates},getWeight:function(t){return e.weight||t.properties.weight},radiusPixels:e.radius||30,intensity:e.intensity||1,threshold:e.threshold||.2,colorRange:e.colorRange?e.colorRange.map((function(e){return t.strToRGBA(e)})):[[160,160,180,250],[10,100,100,250]]});break;case"arc":r=new M.a({data:e.data.features,getSourcePosition:function(t){return t.geometry.coordinates[0]},getTargetPosition:function(t){return t.geometry.coordinates[t.geometry.coordinates.length-1]},getSourceColor:o,getTargetColor:o,getWidth:function(t){return e.width||t.properties.width}});break;default:r=new S.a({data:e.data,pickable:!0,stroked:!1,filled:!0,extruded:!!e.extruded,lineWidthScale:20,lineWidthMinPixels:2,getFillColor:o,getLineColor:o,getRadius:function(t){return e.radius||t.properties.radius},getLineWidth:1,getElevation:function(t){return e.height||t.properties.height}})}n.push(r)})),this.deck.setProps({layers:n})}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$nextTick((function(){var map=new z.a.Map({accessToken:"pk.eyJ1Ijoia2FwYzNkIiwiYSI6ImNpbGpodG82czAwMmlubmtxamdsOHF0a3AifQ.xCbMUsy_a_0A9cd4GvjXKQ",container:t.$refs.map,interactive:!1,style:"mapbox://styles/mapbox/dark-v9",center:[t.viewState.longitude,t.viewState.latitude],zoom:t.viewState.zoom,pitch:t.viewState.pitch,bearing:t.viewState.bearing});t.deck=new _.a({canvas:t.$refs.canvas,width:"100%",height:"100%",initialViewState:t.viewState,controller:!0,onViewStateChange:function(t){var e=t.viewState;map.jumpTo({center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch})}})})),n=document.querySelector("#editor"),t.editor=new l.c.NodeEditor("demo@0.1.0",n),t.editor.use(f.a),t.editor.use(h.a),t.engine=new l.c.Engine("demo@0.1.0"),(r=[new $t,new Tt,new Ft,new Lt,new Ut,new Wt,new Bt,new Yt,new Jt,new Ht,new Xt,new Vt,new Gt,new Zt,new Qt,new re,new ne,new te,new ee,new Kt,new qt]).map((function(e){t.editor.register(e)})),t.Engine=new ae(r),t.editor.on("connectionremoved",function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Engine.process(t.editor.toJSON(),n.input.node.id,t.state);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.editor.on("connectioncreated",function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Engine.process(t.editor.toJSON(),n.input.node.id,t.state);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.editor.on("process",Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Engine.process(t.editor.toJSON(),t.editor.nodeId,t.state);case 2:case"end":return e.stop()}}),e)})))),t.editor.on("noderemove",(function(e){if(e.data.preview){var n=t.state.preview.find((function(t){return t.id===e.data.id}));t.state.preview.splice(t.state.preview.indexOf(n),1)}})),document.addEventListener("keydown",function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n){var r,component,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.editor.selected.list[0],"Delete"!==n.key){e.next=5;break}t.editor.removeNode(r),e.next=17;break;case 5:if(!n.ctrlKey||"c"!==n.key.toLocaleLowerCase()){e.next=9;break}t.copiedNode=r,e.next=17;break;case 9:if(!n.ctrlKey||"v"!==n.key.toLocaleLowerCase()){e.next=17;break}if(!t.copiedNode){e.next=17;break}return component=t.editor.components.get(t.copiedNode.name),e.next=14,component.createNode(t.copiedNode.data);case 14:(o=e.sent).position=[t.copiedNode.position[0]+10,t.copiedNode.position[1]+10],t.editor.addNode(o);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.t0=d,e.next=17,t.$axios.$get("/data/sea-ice-extent.csv");case 17:return e.t1=e.sent,t.state.data["sea-ice"]=e.t0.csvParse.call(e.t0,e.t1),e.next=21,t.$axios.$get("/data/nodes.json");case 21:return t.state.data.nodes=e.sent,e.next=24,t.$axios.$get("/data/links.json");case 24:return t.state.data.links=e.sent,e.t2=d,e.next=28,t.$axios.$get("/data/cars.csv");case 28:return e.t3=e.sent,t.state.data.cars=e.t2.csvParse.call(e.t2,e.t3),e.next=32,t.$axios.$get("/data/branches.json");case 32:return t.state.data.branches=e.sent,e.next=35,t.$axios.$get("/data/arcs.json");case 35:return c=e.sent,t.state.data.arcs=c.map((function(t){return{id:t.id,clients_count:t.clients_count,x:t.source[0],y:t.source[1],x1:t.target[0],y1:t.target[1]}})),e.next=39,t.editor.fromJSON({id:"demo@0.1.0",nodes:{1:{id:1,data:{},position:[500,200],name:"Dataset"}}});case 39:t.saveEditor(!0),t.editor.nodeId=void 0,t.editor.trigger("process"),document.addEventListener("keydown",function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.ctrlKey&&"s"===n.key.toLocaleLowerCase()&&t&&(n.preventDefault(),t.saveEditor());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.editor.on("contextmenu",(function(e){var n=e.e,r=(e.view,e.node);n.preventDefault(),r?t.node=!0:t.node?t.node=!1:r||(t.showMenu=!0,t.menu=[n.clientX,n.clientY],t.searched=null,t.$nextTick((function(){return t.$refs.search.focus()})))})),t.editor.on("click",(function(){t.showMenu=!1}));case 45:case"end":return e.stop()}}),e)})))()}},ie=Object(O.a)(oe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{class:{active:t.msg,red:t.errorMsg},attrs:{id:"save"}},[t._v(t._s(t.msg))]),t._v(" "),t.showMenu?n("div",{staticClass:"context-menu",style:{left:t.menu[0]+"px",top:t.menu[1]+"px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searched,expression:"searched"}],ref:"search",staticClass:"search",attrs:{type:"textarea"},domProps:{value:t.searched},on:{input:function(e){e.target.composing||(t.searched=e.target.value)}}}),t._v(" "),t._l(t.components,(function(component,e){return n("div",{key:e,staticClass:"context-menu-item",class:{"has-children":component.children},on:{click:function(e){return t.createNode(component)},mouseover:function(e){return t.openSideMenu(component,!0)},mouseout:function(e){return t.openSideMenu(component,!1)}}},[component.children?n("div",{staticClass:"context-menu child",class:{hidden:t.hoveredComp!=component.name}},t._l(component.children,(function(e){return n("div",{key:e.name,staticClass:"context-menu-item",on:{click:function(n){return t.createNode(e)}}},[t._v(t._s(e.name))])})),0):t._e(),t._v("\n      "+t._s(component.name)+"\n    ")])}))],2):t._e(),t._v(" "),n("div",{staticClass:"d-flex",attrs:{id:"load"}},[n("div",{staticClass:"btn mrr-20 save cursor-pointer",on:{click:t.saveEditor}}),t._v(" "),n("label",{staticClass:"btn mrr-20 upload cursor-pointer",attrs:{for:"upload"}}),t._v(" "),n("input",{staticClass:"file-input",attrs:{id:"upload",type:"file",accept:"application/json"},on:{change:function(e){return t.load(e)}}}),t._v(" "),n("a",{staticClass:"btn mrr-20 download cursor-pointer",attrs:{href:t.href,download:t.download}})]),t._v(" "),n("div",{attrs:{id:"editor"}}),t._v(" "),n("div",{class:{hidden:0===t.preview.length},attrs:{id:"preview"}},[n("div",{staticClass:"d-flex"},t._l(t.preview,(function(p,e){return n("div",{key:e,staticClass:"preview-item fg-1",class:{selected:e===t.selectedId},on:{click:function(n){return t.select(e)}}},[t._v(t._s(p.name))])})),0),t._v(" "),n("div",{staticClass:"container-preview"},[n("div",{ref:"map",staticClass:"mapbox"}),t._v(" "),n("canvas",{ref:"canvas",staticClass:"deck-canvas"})])]),t._v(" "),n("a",{staticClass:"logo",attrs:{href:"https://itmo.games/lab/",target:"blank"}})])}),[],!1,null,null,null);e.default=ie.exports}}]);